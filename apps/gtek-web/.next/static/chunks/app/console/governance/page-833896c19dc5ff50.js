(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[448],{8573:function(e,s,t){Promise.resolve().then(t.bind(t,655))},655:function(e,s,t){"use strict";t.r(s),t.d(s,{default:function(){return n}});var l=t(1514),a=t(1129),r=t(7993);function n(){let[e,s]=(0,r.useState)(null),[t,n]=(0,r.useState)(null),[i,d]=(0,r.useState)(null),[c,o]=(0,r.useState)(null);return(0,r.useEffect)(()=>{(async()=>{try{let e=await fetch("/api/governance/audit"),t=await e.json();s(t)}catch(e){n(e.message||"error")}})(),(async()=>{try{let e=await fetch("/api/governance/milestones"),s=await e.json();d(s)}catch(e){o(e.message||"error")}})()},[]),(0,l.jsxs)(a.Z,{children:[(0,l.jsx)("h2",{className:"text-xl font-semibold mb-4",children:"Governance Dashboard"}),t&&(0,l.jsxs)("div",{className:"text-red-600 mb-4",children:["Error: ",t]}),!e&&!t&&(0,l.jsx)("div",{children:"Loading…"}),e&&(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Milestone Progress"}),!i&&!c&&(0,l.jsx)("div",{className:"text-sm text-gray-500",children:"Loading milestones…"}),c&&(0,l.jsx)("div",{className:"text-sm text-red-600",children:"Error loading milestones"}),i&&(0,l.jsx)("div",{className:"border p-3 rounded",children:(()=>{var e,s;let t=null!==(s=null===(e=i.milestones)||void 0===e?void 0:e.length)&&void 0!==s?s:0,a=(i.milestones||[]).filter(e=>"done"===e.status).length;return(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"w-full bg-slate-200 rounded-full h-2 mb-3",children:(0,l.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(t>0?Math.round(a/t*100):0,"%")}})}),(0,l.jsx)("ul",{className:"text-xs space-y-1",children:(i.milestones||[]).map(e=>(0,l.jsxs)("li",{children:["done"===e.status&&"✅"," ","in-progress"===e.status&&"\uD83D\uDD04"," ","pending"===e.status&&"⬜"," ",e.title]},e.id))})]})})()})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Last 24h"}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,l.jsxs)("div",{className:"border p-3 rounded",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Total audit events"}),(0,l.jsx)("div",{className:"text-2xl",children:e.stats.total})]}),(0,l.jsxs)("div",{className:"border p-3 rounded",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Rate limit hits"}),(0,l.jsx)("div",{className:"text-2xl",children:e.stats.rateLimits})]})]}),e.mock&&(0,l.jsx)("div",{className:"text-xs text-gray-500 mt-2",children:"Mock data (no Supabase configured)"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h3",{className:"font-medium mb-2",children:"Recent rate limit events"}),(0,l.jsx)("div",{className:"overflow-x-auto text-xs",children:(0,l.jsxs)("table",{className:"min-w-full border",children:[(0,l.jsx)("thead",{children:(0,l.jsxs)("tr",{className:"bg-gray-50",children:[(0,l.jsx)("th",{className:"text-left p-2 border",children:"Time (UTC)"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"IP"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"Path"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"Count"}),(0,l.jsx)("th",{className:"text-left p-2 border",children:"Limit"})]})}),(0,l.jsx)("tbody",{children:e.events.map((e,s)=>{var t,a;let r=e.meta||{};return(0,l.jsxs)("tr",{children:[(0,l.jsx)("td",{className:"p-2 border",children:new Date(e.created_at).toISOString()}),(0,l.jsx)("td",{className:"p-2 border",children:r.ip||"-"}),(0,l.jsx)("td",{className:"p-2 border",children:r.path||"-"}),(0,l.jsx)("td",{className:"p-2 border",children:null!==(t=r.count)&&void 0!==t?t:"-"}),(0,l.jsx)("td",{className:"p-2 border",children:null!==(a=r.limit)&&void 0!==a?a:"-"})]},s)})})]})})]})]})]})}},1129:function(e,s,t){"use strict";t.d(s,{Z:function(){return a}});var l=t(1514);function a(e){let{children:s}=e;return(0,l.jsxs)("div",{className:"min-h-screen",children:[(0,l.jsxs)("nav",{className:"p-3 border-b flex gap-3 text-sm",children:[(0,l.jsx)("a",{href:"/",children:"Home"}),(0,l.jsx)("a",{href:"/console",children:"Console"}),(0,l.jsx)("a",{href:"/console/vault",children:"Vault"}),(0,l.jsx)("a",{href:"/console/governance",children:"Governance"})]}),(0,l.jsx)("div",{className:"p-6",children:s})]})}}},function(e){e.O(0,[869,753,744],function(){return e(e.s=8573)}),_N_E=e.O()}]);